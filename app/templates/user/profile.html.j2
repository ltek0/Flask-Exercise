{% extends "base.html.j2" %}
{% block content %}
  <style>
  .pofile{
    margin:0
  }
  </style>
  <h1>Profile</h1>
  <table class="profile">
    <tr valign="top">
      <td>
        <img src="{{ user.avatar(128) }}" />
      </td>
      <td>
        <h1>User: {{ user.display_name }}</h1>
        <p>Username: {{ user.username }}</p>
        {% if user.bio %}<p>{{ user.bio }}</p>{% endif %}
        {% if user.last_seen %}<p>Last seen on: {{ user.last_seen }}</p>{% endif %}
        <p>Follower: {{ user.followers_count }}</p>
        {% if current_user.username == user.username %}
          <a href="{{ url_for('edit_profile',username = current_user.username) }}">Edit your profile</a>
        {% endif %}
        {% if current_user.is_authenticated: %}
          {% if current_user.username != user.username and not current_user.is_following(user) %}
            <form action="{{ url_for('follow', uname = current_user.username, funame = user.username) }}"
                  method="post">
              <input type="submit" value="Follow" />
            </form>
          {% elif current_user.username != user.username and current_user.is_following(user) %}
            <form action="{{ url_for('follow', uname = current_user.username, funame = user.username) }}"
                  method="post">
              <input type="submit" value="Unfollow" />
            </form>
          {% endif %}
        {% endif %}
      </td>
    </tr>
  </table>
  <hr />
  {% for post in posts %}
    <table>
      <tr valign="top">
        <td>
          <img src="{{ post.author.avatar(36) }}" />
        </td>
        <td>
          {{ post.author.display_name }}: {{ post.title }}
          <br />
          <a href="{{ url_for('view_post', post_id = post.id) }}">{{ post.preview }}</a>
        </td>
      </tr>
    </table>
  {% endfor %}
{% endblock %}
